"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[22],{75583:function(ce,K,a){a.r(K),a.d(K,{default:function(){return pe}});var ee=a(15009),i=a.n(ee),ae=a(99289),j=a.n(ae),re=a(5574),S=a.n(re),B=a(88001),D=a(88634),G=a(86250),V=a(14726),f=a(67294),w={mainContainter:"mainContainter____c8Do",pageTitle:"pageTitle___gp6PZ",mainContent:"mainContent___XEhNz",GenerateBotChat:"GenerateBotChat___r2_CS",GenerateBotForm:"GenerateBotForm___dazg2"},Y=a(65136),Z=a(67984),te=a(52752),X=a(5966),ne=a(64317),se=a(90672),b=a(24739),T=a(25054),P=a(31199),le=a(72269),oe=a(63606),ie=a(97937),$={botForm:"botForm___KZBBY",formFooter:"formFooter___S6Y43",label:"label___Hnory"},e=a(85893);function ue(H){var g=H.botId,C=H.onUpdate,U=(0,f.useState)(new Z.Z(g)),N=S()(U,2),c=N[0],p=N[1],k=(0,f.useState)(!1),R=S()(k,2),F=R[0],O=R[1],W=(0,f.useState)(!1),z=S()(W,2),d=z[0],y=z[1],I=(0,f.useRef)(),E=function(){var v=j()(i()().mark(function h(o){return i()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!g){t.next=6;break}return t.next=3,c.update(o);case 3:C&&C(c),t.next=9;break;case 6:return t.next=8,c.create(o);case 8:D.history.push("/bot/"+c.id);case 9:case"end":return t.stop()}},h)}));return function(o){return v.apply(this,arguments)}}(),A=function(){var v=j()(i()().mark(function h(){var o,r;return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!c.id){n.next=6;break}return n.next=3,c.get();case 3:r=n.sent,(o=I.current)===null||o===void 0||o.setFieldsValue(r),C&&C(c);case 6:case"end":return n.stop()}},h)}));return function(){return v.apply(this,arguments)}}();return(0,f.useEffect)(function(){p(new Z.Z(g))},[g]),(0,f.useEffect)(function(){A()},[c]),(0,e.jsxs)(te.A,{className:$.botForm,onFinish:E,formRef:I,submitter:{render:function(h,o){return F?(0,e.jsx)(V.ZP,{type:"primary",onClick:function(){O(!1)},children:"Edit"}):(0,e.jsxs)("div",{className:$.formFooter,children:[o,(0,e.jsx)("span",{className:$.label,children:"More Options:"}),(0,e.jsx)(le.Z,{checkedChildren:(0,e.jsx)(oe.Z,{}),unCheckedChildren:(0,e.jsx)(ie.Z,{}),checked:d,onChange:function(t){y(t)}})]})},searchConfig:{submitText:"Save"}},readonly:F,layout:"vertical",grid:!0,initialValues:c,request:j()(i()().mark(function v(){var h;return i()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,c.get();case 2:return h=r.sent,r.abrupt("return",h);case 4:case"end":return r.stop()}},v)})),rowProps:{gutter:[16,0]},children:[(0,e.jsx)(X.Z,{name:"title",label:"Title",rules:[{required:!0}]}),(0,e.jsx)(ne.Z,{name:"model",label:"Model",request:j()(i()().mark(function v(){return i()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",B.aH.map(function(r){return{value:r.key,label:r.label}}));case 1:case"end":return o.stop()}},v)})),rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4E00\u4E2A\u6A21\u578B"}]}),(0,e.jsx)(se.Z,{name:"systemPrompt",label:"System Prompt",rules:[{required:!0}],fieldProps:{autoSize:{minRows:d?4:16,maxRows:d?4:16}}}),(0,e.jsxs)(b.UW,{size:36,colProps:{md:12},style:{display:d?"block":"none"},children:[(0,e.jsx)(T.Z,{name:"temperature",label:"Temperature",layout:"horizontal",colProps:{md:16},min:0,max:2,step:.01,marks:{0:"0",2:"2"}}),(0,e.jsx)(P.Z,{name:"temperature",label:" ",min:0,colProps:{md:6},max:2})]}),(0,e.jsxs)(b.UW,{size:36,colProps:{md:12},style:{display:d?"block":"none"},children:[(0,e.jsx)(T.Z,{name:"frequency_penalty",label:"Frequency Penalty",width:"md",min:-2,max:2,colProps:{md:16},step:.01,marks:{"-2.0":"-2.0",2:"2.0"}}),(0,e.jsx)(P.Z,{name:"frequency_penalty",label:" ",min:-2,colProps:{md:6},max:2})]}),(0,e.jsxs)(b.UW,{size:36,colProps:{md:12},style:{display:d?"block":"none"},children:[(0,e.jsx)(T.Z,{name:"presence_penalty",label:"Presence Penalty",width:"md",min:-2,max:2,step:.01,colProps:{md:16},marks:{"-2.0":"-2.0",2:"2.0"}}),(0,e.jsx)(P.Z,{name:"presence_penalty",label:" ",min:-2,colProps:{md:6},max:2})]}),(0,e.jsxs)(b.UW,{size:36,colProps:{md:12},style:{display:d?"block":"none"},children:[(0,e.jsx)(T.Z,{name:"top_p",label:"Top P",width:"md",min:0,max:1,step:.01,colProps:{md:16},marks:{0:"0",1:"1"}}),(0,e.jsx)(P.Z,{name:"top_p",label:" ",min:0,colProps:{md:6},max:1})]}),(0,e.jsx)(b.UW,{size:36,colProps:{md:12},style:{display:d?"block":"none"},children:(0,e.jsx)(P.Z,{name:"max_tokens",label:"Max Tokens",width:"xs",colProps:{md:12}})}),(0,e.jsx)(b.UW,{size:36,colProps:{md:12},style:{display:d?"block":"none"},children:(0,e.jsx)(X.Z,{name:"stop",label:"Stop",width:"md",colProps:{md:24},style:{display:d?"block":"none"}})}),(0,e.jsx)(b.UW,{size:36,colProps:{md:12},style:{display:d?"block":"none"},children:(0,e.jsx)(P.Z,{name:"maxDisplayRounds",label:"Max Display Rounds",width:"xs",colProps:{md:24}})}),(0,e.jsx)(b.UW,{size:36,colProps:{md:12},style:{display:d?"block":"none"},children:(0,e.jsx)(P.Z,{name:"maxMemoryRounds",label:"Max Memory Rounds",width:"xs",colProps:{md:24}})})]})}var de=ue,me=function(){var g=(0,D.useParams)(),C=g.id,U=function(){if(C!==void 0)return parseInt(C)},N=(0,f.useState)(U()),c=S()(N,2),p=c[0],k=c[1],R=(0,f.useState)("Edit Bot"),F=S()(R,2),O=F[0],W=F[1],z=(0,f.useState)(""),d=S()(z,2),y=d[0],I=d[1],E=B.K4,A=function(){var r=j()(i()().mark(function t(){var n,u;return i()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return n=new Z.Z(p),l.next=3,n.get();case 3:u=l.sent,u.helperChatId&&I(u.helperChatId);case 5:case"end":return l.stop()}},t)}));return function(){return r.apply(this,arguments)}}();(0,f.useEffect)(function(){p&&A()},[p]),(0,f.useEffect)(function(){k(U())},[C]);var v=function(){var r=j()(i()().mark(function t(n){var u;return i()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!n.id){l.next=10;break}return l.next=3,n.get();case 3:if(u=l.sent,W(u.title),!(y&&n.helperChatId!==y)){l.next=9;break}return u.helperChatId=y,l.next=9,n.update(u);case 9:k(n.id);case 10:case"end":return l.stop()}},t)}));return function(n){return r.apply(this,arguments)}}(),h=function(){var r=j()(i()().mark(function t(n){var u,x;return i()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(I(n),!p){m.next=10;break}return u=new Z.Z(p),m.next=5,u.get();case 5:if(x=m.sent,!(y&&u.helperChatId!==y)){m.next=10;break}return x.helperChatId=y,m.next=10,u.update(x);case 10:case"end":return m.stop()}},t)}));return function(n){return r.apply(this,arguments)}}(),o=function(){var r=j()(i()().mark(function t(n){var u,x,l,m,J,M,L,Q,q,_;return i()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(u=/```json\s*([\s\S]*?)\s*```/,x=n.match(u),!x){s.next=33;break}if(l=x[1],s.prev=4,m=JSON.parse(l),!m){s.next=26;break}if(!p){s.next=20;break}return J=new Z.Z(p),s.next=11,J.get();case 11:return M=s.sent,M.systemPrompt=m.prompt,M.title=m.title,s.next=16,J.update(M);case 16:L=s.sent,k(L.id),s.next=26;break;case 20:return Q={title:m.title,createdAt:new Date,model:B.pk,systemPrompt:m.prompt,frequency_penalty:0,presence_penalty:0,temperature:1,top_p:1,stop:[],maxDisplayRounds:B.xf,maxMemoryRounds:B.DI},q=new Z.Z,s.next=24,q.create(Q);case 24:_=s.sent,k(_.id);case 26:s.next=31;break;case 28:s.prev=28,s.t0=s.catch(4),console.error("Invalid JSON format:",s.t0);case 31:s.next=34;break;case 33:console.log("No JSON found.");case 34:case"end":return s.stop()}},t,null,[[4,28]])}));return function(n){return r.apply(this,arguments)}}();return(0,e.jsxs)("div",{className:w.mainContainter,children:[(0,e.jsxs)(G.Z,{justify:"space-between",className:w.pageTitle,children:[(0,e.jsx)("h2",{children:p?O:"New Bot"}),p?(0,e.jsx)(V.ZP,{type:"primary",onClick:function(){D.history.push("/?bot="+p)},children:"New Chat"}):""]}),(0,e.jsxs)(G.Z,{className:w.mainContent,children:[(0,e.jsx)("div",{className:w.GenerateBotChat,children:(0,e.jsx)(Y.Z,{model:E,chat:y,bot:p,type:Y.z.GenerateBot,chatIdUpdate:h,messageHandler:o})}),(0,e.jsx)(G.Z,{className:w.GenerateBotForm,children:(0,e.jsx)(de,{botId:p,onUpdate:v})})]})]})},pe=me}}]);
